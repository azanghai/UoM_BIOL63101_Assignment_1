---
title: "11082245_BIOL63101_Assignment1"
author: '11082245'
date: "2022-11-17"
output: 
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: false
    toc_float: TRUE
    default_style: "dark"
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Before Reading

The R script and R Markdown file were uploaded to [my GitHub repository](https://github.com/azanghai/UoM_BIOL63101_Assignment_1), where you can view or download my code.

**To get the best browsing experience, maximize the browser.**

**You can use the switch button on the left if you want to switch to a different colour theme.**

------------------------------------------------------------------------

# Import Required Packages

```{r,import_libraty_chunk,message=FALSE,warning=FALSE}
library(tidyverse)
library(dplyr)
library(ggridges)
library(skimr)
library(ggpubr)
library(descriptr)
```

The `skimr` and `descriptr` packages are used to calculate descriptive statistics. The `ggpubr` package is used to draw a bar chart with compared means. Other packages are from the class.

------------------------------------------------------------------------

# Import Data

I use a built-in function to import `.csv` data and name it `raw_data`.

```{r,import_data_chunk}
# importing raw data
raw_data <- read.csv("assignment_1_data.csv")
```

------------------------------------------------------------------------

# Convert Data into Long Format {.tabset .tabset-fade .tabset-pills}

The data needs to be converted into the long format for further analysis, which can be achieved in two ways.

## Using gather()

```{r,data_convert_1}
converted_data <- gather(
  data = raw_data,
  key = "Conditions",
  value = "RT",
  2:5
)
```

---

## Using pivot_longer()

```{r,data_convert_2}
converted_data <- raw_data %>%
  pivot_longer(
    cols = c(Condition1, Condition2, Condition3, Condition4),
    names_to = "Conditions",
    values_to = "RT"
  )
```

------------------------------------------------------------------------

# Make some adjustments for the labels to be human-readable.

Conditions are renamed by their meaning, for example:

> `Condition1` was transferred to `ExpNum_Num`, which means Condition1 corresponds to Expectation of a Number, and a subsequent Number Target.

Also, for the needs of plotting. I have created two new columns to represent what Expectations and Targets are.

```{r,rewrite_condition}
# rewrite conditions
converted_data = converted_data %>%
  mutate(Conditions = factor(Conditions)) %>%
  mutate(
    Conditions = case_when(
      Conditions == "Condition1" ~ "ExpNum_Num",
      Conditions == "Condition2" ~ "ExpNum_Let",
      Conditions == "Condition3" ~ "ExpLet_Num",
      Conditions == "Condition4" ~ "ExpLet_Let"
    )
  ) %>%
  mutate(
    Expectation = case_when(
      Conditions == "ExpNum_Num" ~ "Number",
      Conditions == "ExpNum_Let" ~ "Number",
      Conditions == "ExpLet_Let" ~ "Letter",
      Conditions == "ExpLet_Num" ~ "Letter"
    )
  ) %>%
  mutate(
    Target = case_when(
      Conditions == "ExpNum_Num" ~ "Number",
      Conditions == "ExpNum_Let" ~ "Letter",
      Conditions == "ExpLet_Let" ~ "Letter",
      Conditions == "ExpLet_Num" ~ "Number"
    )
  ) %>%
  mutate(Expectation = factor(Expectation)) %>%
  mutate(Target = factor(Target))
```

I have also reordered the sequence of conditions to demonstrate plots in a better way.

```{r,reorder_factor}
# reorder factor sequence
converted_data <- converted_data %>%
  mutate(Conditions = factor(Conditions, 
                             levels = c("ExpNum_Num",
                                        "ExpNum_Let",
                                        "ExpLet_Let",
                                        "ExpLet_Num")))
```

------------------------------------------------------------------------

# Summary Statistics for Each Condition {.tabset .tabset-fade .tabset-pills}

Summary statistics report was generated by using R packages. I found two different packages which suit this task.

## Using `skimr` package

The `skimr` package provides a simple way to look at descriptive statistics for the data. It provides Mean, SD, Quantile and mini histogram.

```{r,skim_data_summary}
# take a look about data summary.
converted_data %>%
  dplyr::group_by(Conditions) %>%
  skim() %>%
  dplyr::filter(skim_variable == "RT")
```

---

## Using `descriptr` package

The `descriptr` package provides more descriptive statistics.

```{r,descriptr_data_summary}
# descriptr can also do this
converted_data %>%
  filter(Conditions == "ExpNum_Num") %>%
  ds_summary_stats()
converted_data %>%
  filter(Conditions == "ExpNum_Let") %>%
  ds_summary_stats()
converted_data %>%
  filter(Conditions == "ExpLet_Num") %>%
  ds_summary_stats()
converted_data %>%
  filter(Conditions == "ExpLet_Let") %>%
  ds_summary_stats()
```

------------------------------------------------------------------------

# Visualizations

## Visualizations for Each Condition

### General Overview {.tabset .tabset-fade .tabset-pills}

The density plot gives us a general overview about how data is distributed. he plot shows that the reaction time(RT) is different *when expectation and target are consistent* and *when they are not*. Meanwhile, it seems that the data in each condition is normally distributed.

#### Separated Density Plot

```{r,Density_Plot_Under_Each_Condition,fig.align='center',out.width='100%',out.height='100%',fig.cap="Density Plot Under Each Condition"}
ggplot(data = converted_data, aes(x = RT)) +
  geom_density(aes(fill = Conditions), alpha = .3) +
  facet_wrap(~Conditions) +
  labs(y = "Density") +
  theme(legend.position = "none")
```

---

#### Density Ridges Plot

```{r,Density_Ridges_Plot,fig.cap='Density Ridges Plot',fig.align='center',out.width='100%',out.height='100%'}
ggplot(data = converted_data) +
  geom_density_ridges(mapping = aes(x = RT, y = Conditions, fill = Conditions),
                      alpha = .7) +
  theme(legend.position = "none")
```

------------------------------------------------------------------------

## Discovery about distribution

And if we put the data in ascending order and in the same plot, we can find a huge difference between the two data groups.

```{r,distribution_1,fig.align='center',fig.cap='Scatter Plot for 4 Conditions',out.width='100%',out.height='100%'}
ggplot(mapping = aes(
  x = rank(RT),
  y = RT
)) +
  geom_point(
    data = filter(converted_data, Conditions == "ExpNum_Num"),
    color = "red"
  ) +
  geom_point(
    data = filter(converted_data, Conditions == "ExpNum_Let"),
    color = "green"
  ) +
  geom_point(
    data = filter(converted_data, Conditions == "ExpLet_Let"),
    color = "orange"
  ) +
  geom_point(
    data = filter(converted_data, Conditions == "ExpLet_Num"),
    color = "blue"
  )
```

We can draw a Q-Q plot to find whether the data is distributed normally.

```{r,qq_plot,fig.align='center',fig.cap='Q-Q plot for Each Condition',out.width='100%',out.height='100%'}
# distribution check
ggplot(data = converted_data, aes(sample = RT, colour = factor(Conditions))) +
  geom_qq() +
  geom_qq_line() +
  facet_wrap(~Conditions)
```

The data seems perfect and normally distributed(by viewing the plot).

------------------------------------------------------------------------

## Plot with More Information

We can also view the data in a different plot which may provide more information.

```{r,mix_plot,fig.align='center',fig.cap='A Mixed Plot Which Provies More Information',out.width='100%',out.height='100%'}
# The plot is developed with interaction effects(Expecation x Target)
ggplot(data = converted_data,
       mapping = aes(x = Expectation:Target,
                     y = RT, 
                     colour = Conditions, )) +
  geom_violin() +
  geom_jitter(width = .5, alpha = .5) +
  geom_boxplot(alpha = .5) +
  guides(colour = "none") +
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = .5)) +
  labs(x = "Expecation x Target")
```

From the plot we can also discover the difference *when the expectation and target are consistent* and *when they are not*.

------------------------------------------------------------------------

## Data Comparisons

From the plots above, we can learn that there may be a difference *when the expectation and target are consistent* and *when they are not*. But we still need to verify. Therefore, a bar chart is created, and the difference in mean value under two different circumstances is examined(in paired t-test).

```{r,bar_chart,warning=FALSE,message = FALSE,results='hide',fig.align='left',fig.cap='****p<0.0001',out.width='100%',out.height='100%'}
# take a look at data in each condition.
ggplot(data = converted_data, aes(x = Conditions, y = RT, fill = Conditions)) +
  # use stat_summary to calculate mean and add a layer of error bar,which can be used by the next layer
  stat_summary(fun = "mean", geom = "bar") +
  stat_summary(
    fun.data = "mean_sd",
    geom = "errorbar",
    color = "black",
    width = .25,
    position = position_dodge(.9)
  ) +
  stat_compare_means(
    comparisons = list(c("ExpLet_Let", "ExpLet_Num"),
                       c("ExpNum_Num", "ExpNum_Let")),
    # use paired t-test here
    paired = TRUE,
    symnum.args = list(
      # use * to illustrate the p value
      cutpoints = c(0, 0.0001, 0.001, 0.01, 0.05, Inf),
      symbols = c("****", "***", "**", "*", "ns")
    )
  ) +
  labs(title = "Bar Chart to Compare Different Conditions") +
  theme(legend.position = "none", plot.title = element_text(hjust = 0.5))
```

The chart shows us that the difference between *when the expectation and target are consistent* and *when they are not* is significant(p\<0.0001).

<center>------The End------</center>
